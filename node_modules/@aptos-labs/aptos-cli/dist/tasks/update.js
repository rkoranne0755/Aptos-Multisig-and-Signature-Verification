import { existsSync } from "fs";
import { execSyncShell } from "../utils/execSyncShell.js";
import { getLatestVersion } from "../utils/getAptosCliLatestVersion.js";
import { installCli } from "./install.js";
import { getLocalBinPath } from "../utils/getLocalBinPath.js";
export const updateCli = async () => {
    const path = getLocalBinPath();
    if (!existsSync(path)) {
        console.log("Aptos CLI not installed, run `npx aptos --install` to install");
        return;
    }
    const latestVersion = await getLatestVersion();
    const currentVersion = execSyncShell(`${path} --version`, {
        encoding: "utf8",
    })
        .trim()
        .split(" ")[1];
    if (currentVersion !== latestVersion) {
        console.log(`A newer version of the CLI is available: ${latestVersion}, installing...`);
        installCli();
    }
    else {
        console.log(`CLI is up to date`);
    }
};
//# sourceMappingURL=update.js.map